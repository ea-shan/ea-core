let taxArgs={},currentPageObj={},GSFilterobserver=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(GSFilterobserver.unobserve(e.target),gspbLoadMorepaginationHandler(e.target,"infinitescroll"))})},{root:null,threshold:.5});function GSFilterDebounce(e,t=300){let a;return(...r)=>{a&&clearTimeout(a),a=setTimeout(()=>{e.apply(this,r)},t)}}const GSdebouncedHandle=GSFilterDebounce(GShandleFilterEvent,1e3);async function GShandleFilterEvent(e){let{filter:t,slug:a,connection:r,min:n,max:l,val:s,waschecked:i,relation:o,operator:d}=e.dataset,g=e.value,c=e.type;if(!r||!document.getElementById(r))return console.log("dataConnectionId or targetElement doens't exists"),!1;let u=document.getElementById(r),p=u?.dataset.paginationtype;switch(taxArgs[r],t){case"tax_query":switch(c){case"radio":i===g&&(e.checked=!1,e.setAttribute("data-waschecked",""),taxArgs[r]&&taxArgs[r][a]&&(delete taxArgs[r][a],taxArgs[r].filteredIndexData.tax_query&&(taxArgs[r].filteredIndexData.tax_query[a]=[]))),e.checked&&(e.setAttribute("data-waschecked",g),taxArgs[r][a]||GSupdateTaxArgsObj(taxArgs[r],a,d),taxArgs[r][a]={taxonomy:a,field:"slug",terms:[g],operator:d},taxArgs[r].filteredIndexData.tax_query[a],taxArgs[r].filteredIndexData.taxOperator=d,taxArgs[r].filteredIndexData.tax_query[a]=[s]);break;case"checkbox":e.checked?(taxArgs[r][a]||GSupdateTaxArgsObj(taxArgs[r],a,d),taxArgs[r][a]?.terms.includes(g)||GSupdateTaxQuery(taxArgs[r],a,g,s,d),taxArgs[r].filteredIndexData.taxOperator=d):taxArgs[r][a]&&taxArgs[r][a]?.terms.includes(g)&&GSremoveTermFromTaxQuery(taxArgs[r],a,g,s);break;case"select-one":if(""!==g){let f=e?.options[e?.selectedIndex],y=f.getAttribute("data-val");taxArgs[r][a]||GSupdateTaxArgsObj(taxArgs[r],a,d),taxArgs[r][a]={taxonomy:a,field:"slug",terms:[g],operator:d},taxArgs[r].filteredIndexData.tax_query[a],taxArgs[r].filteredIndexData.tax_query[a]=[y],taxArgs[r].filteredIndexData.taxOperator=d}else delete taxArgs[r][a]}break;case"meta_query":switch(c){case"radio":i===g&&(e.checked=!1,e.setAttribute("data-waschecked",""),taxArgs[r]&&taxArgs[r][a]&&(delete taxArgs[r][a],taxArgs[r].filteredIndexData.meta_query&&(taxArgs[r].filteredIndexData.meta_query[a]=[]))),e.checked&&(e.setAttribute("data-waschecked",g),taxArgs[r][a]||GSupdateMetaArgsObj(taxArgs[r],a,g),taxArgs[r][a]={key:a,value:[g],compare:"IN"},taxArgs[r].filteredIndexData.meta_query[a],taxArgs[r].filteredIndexData.meta_query[a]=[s]);break;case"checkbox":e.checked?(taxArgs[r][a]||GSupdateMetaArgsObj(taxArgs[r],a),taxArgs[r][a]?.value?.includes(g)||GSupdateMetaQuery(taxArgs[r],a,g,s)):taxArgs[r][a]&&taxArgs[r][a]?.value.includes(g)&&GSremoveMetaFromMetaQuery(taxArgs[r],a,g,s);break;case"select-one":if(""!==g){let x=e?.options[e?.selectedIndex],m=x.getAttribute("data-val");taxArgs[r][a]||GSupdateMetaArgsObj(taxArgs[r],a),taxArgs[r][a]={key:a,value:[g],compare:"IN"},taxArgs[r].filteredIndexData.meta_query[a],taxArgs[r].filteredIndexData.meta_query[a]=[m]}else delete taxArgs[r][a];break;case"range":taxArgs[r][a]||GSupdateMetaRangeObj(taxArgs[r],a),taxArgs[r][a]={key:a,value:[n,l],compare:"BETWEEN",type:"numeric"};let b=a+"|range",A={minmax:n+"|"+l,defaultMin:e.min,defaultMax:e.max};taxArgs[r].filteredIndexData.meta_query[b]=A}break;case"search":""!==g?(taxArgs[r].search=g,taxArgs[r].filteredIndexData.search_keyword=g):(delete taxArgs[r].search,taxArgs[r].filteredIndexData.search_keyword="");break;case"woo_sorting":let S=e?.options[e?.selectedIndex],h=S.getAttribute("data-val"),I={default:{meta_key:"",orderby:"",order:""},popularity:{meta_key:"total_sales",orderby:"meta_value_num",order:"DESC"},rating:{meta_key:"_wc_average_rating",orderby:"meta_value_num",order:"DESC"},date:{meta_key:"",orderby:"date",order:"DESC"},price:{meta_key:"_price",orderby:"meta_value_num",order:"ASC"},"price-desc":{meta_key:"_price",orderby:"meta_value_num",order:"DESC"}},q=I[h]||I.default;taxArgs[r].meta_key=q.meta_key,taxArgs[r].orderby=q.orderby,taxArgs[r].order=q.order;break;case"custom_sorting":let k=e?.options[e?.selectedIndex],v=k.getAttribute("data-val"),D=k.getAttribute("data-key"),G={default:{meta_key:"",orderby:"",order:""},date_desc:{meta_key:"",orderby:D,order:"DESC"},date_asc:{meta_key:"",orderby:D,order:"ASC"},title_desc:{meta_key:"",orderby:D,order:"DESC"},title_asc:{meta_key:"",orderby:D,order:"ASC"},custom_field_desc:{meta_key:D,orderby:"meta_value",order:"DESC"},custom_field_asc:{meta_key:D,orderby:"meta_value_num",order:"ASC"}},$=G[v]||G.default;taxArgs[r].meta_key=$.meta_key,taxArgs[r].orderby=$.orderby,taxArgs[r].order=$.order}filterdata=GSgenerateFilterData(r,u,p,1),currentPageObj[r]={currentPaged:1,filterPanelEnable:!0},await Promise.all([GSfilter_by_rest_func(filterdata,"filter",p),GSrefreshCountRestCall(taxArgs[r].filteredIndexData,r,taxArgs[r])]);let w=document.querySelector(`.gspb__filters-chips[data-filterid=${r}]`);if(w){await GSrefreshFilterChips(taxArgs[r].filteredIndexData,w,r);let C=w.querySelectorAll(".gspb-filter-chip");C.length>0&&document.body.addEventListener("click",async function(e){let t=e.target.closest(".gspb-filter-chip");if(t){if(t.classList.contains("gspb-chip-reset-all")){let a=GSresetFilterData(r,u,"all",p),n=t.getAttribute("data-connectionid"),l=document.querySelector(`.gspb__filters-chips[data-filterid=${n}]`);GSclearSelectedTags("all",n),await Promise.all([GSfilter_by_rest_func(a,"filter",p),GSrefreshCountRestCall(taxArgs[r].filteredIndexData,r),GSrefreshFilterChips(taxArgs[r].filteredIndexData,l,r)])}else{let s=t.getAttribute("data-val"),i=t.getAttribute("data-slug"),o=t.getAttribute("data-type"),d=t.getAttribute("data-filter"),g=t.getAttribute("data-key"),c=t.getAttribute("data-min"),f=t.getAttribute("data-max"),y=t.getAttribute("data-class"),x=t.getAttribute("data-connectionid"),m=document.querySelector(`.gspb__filters-chips[data-filterid=${x}]`),b=t.getAttribute("data-minmax");"range__input"===o&&(s="range__input"),GSclearSelectedTags(s,r,i,y);let A=GSresetFilterData(r,u,"single",p,i,d,g,s,{min:c,max:f,type:o,minmax:b});await Promise.all([GSfilter_by_rest_func(A,"filter",p),GSrefreshCountRestCall(taxArgs[r]?.filteredIndexData,r),GSrefreshFilterChips(taxArgs[r].filteredIndexData,m,r)])}}})}}function GSclearSelectedTags(e,t,a,r){let n=document.querySelector(`.gspb-filterpanel[data-filterid="${t}"]`),l=n.querySelectorAll('.gspb-filterblock[data-range="range"]');if(n){if("all"!==e){let s;if("checkbox"===(s="gspb-search"===e?n.querySelector(`.${e}`):"range__input"===e?n.querySelector(`.${r}`):n.querySelector(`[data-val="${e}"]`)).type||"radio"===s.type)s.checked=!1;else if("select"===s.tagName.toLowerCase())s.selectedIndex=0;else if("input"===s.tagName.toLowerCase()&&"text"===s.type)s.value="";else if("range"===s.type){let i=n.querySelector(`.gspb-filterblock[data-query="${a}"][data-range="range"]`),o=i.getAttribute("data-minmax"),d=o.split("|"),g=s.getAttribute("data-minActive"),c=s.getAttribute("data-maxActive"),u=i.querySelector(".gspb-range__slider-display"),p=i.querySelector(".gspb-range__slider");s.dataset.min=d[0],s.dataset.max=d[1],g&&(s.value=d[0],u.setAttribute("data-low",d[0]),p.style.setProperty("--gspb-range-slider-low-val",0)),c&&(s.value=d[1],u.setAttribute("data-high",d[1]),p.style.setProperty("--gspb-range-slider-high-val",100))}}else{let f=n.querySelectorAll("input");f.forEach(e=>{switch(e.type){case"checkbox":case"radio":e.checked=!1;break;case"text":e.value="";break;case"range":l.forEach(t=>{let a=t.getAttribute("data-minmax"),r=a.split("|"),n=t.querySelectorAll(".gspb-range__slider-input"),l=t.querySelector(".gspb-range__slider-display"),s=t.querySelector(".gspb-range__slider");l.setAttribute("data-low",r[0]),l.setAttribute("data-high",r[1]),s.style.setProperty("--gspb-range-slider-low-val",0),s.style.setProperty("--gspb-range-slider-high-val",100),e.dataset.min=r[0],e.dataset.max=r[1],n[0].value=r[0],n[1].value=r[1]})}});let y=n.querySelectorAll("select");y.forEach(e=>{e.options.length>0&&(e.selectedIndex=0)})}}}function GSgenerateFilterData(e,t,a,r=1){if(!e)return console.log("dataConnectionId doesn't exist!"),!1;let n=t.dataset,l=e.replace(/-/g,"_"),s=void 0!==window[l]?window[l]:"",i=GSgetBlockInstance(e),o=i?.attrs?.post_type,d=i?.attrs?.show;taxArgs[e]||(taxArgs[e]={}),taxArgs[e].post_type=o||"post",taxArgs[e].posts_per_page=d||12,taxArgs[e].filteredIndexData.post_type=o||"post";let g=n?.filterargs?JSON.parse(n?.filterargs):{},{finalTaxArgs:c,finalMetaArgs:u}=GSprepareFilterQuery(taxArgs,e);Object.assign(g,{tax_query:c,meta_query:u,s:taxArgs[e]?.search,post_type:taxArgs[e].post_type,posts_per_page:taxArgs[e].posts_per_page,meta_key:taxArgs[e].meta_key,orderby:taxArgs[e].orderby,order:taxArgs[e].order});let p=document.querySelector(`#${e} .wp-block-post-template`),f=document.querySelector(`#${e} .gspb-filter__ajx-pagination`),y=GSgenerateLoader(p,e),x=f&&f.querySelector(".gspb-filter__load_moreajx_btn")?f.querySelector(".gspb-filter__load_moreajx_btn").textContent:"";return{filterargs:JSON.stringify(g),template:n.template,containerid:e,filterconnection:e,offset:void 0,currentpage:r,paginationtype:a,innerargs:n.innerargs,blockinstance:s,querycontainer:p,paginationcontainer:f,loaderContainer:y,loadmoretext:x,allArgs:JSON.stringify(taxArgs[e])}}async function GSfilter_by_rest_func(e,t="",a=""){let{querycontainer:r,paginationcontainer:n,containerid:l,loaderContainer:s}=e,i,o=document.querySelector(`#${l}`).closest(".gs-swiper-init");s.style.display="flex",s.classList.add("loading");let d=new XMLHttpRequest;d.open("POST",RESTVARS.rest_url,!0),d.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),d.responseType="json",d.onload=function(){if(this.status>=200&&this.status<400){s.style.display="none",s.classList.remove("loading");let{html:d,paginationHtml:g,currentPage:c,maxPage:u,filterConnectionId:p,resultsCount:f}=this.response.data,y=Math.floor(1e5*Math.random()),x=d.replace(/gspbgrid_item /g,"gspbgrid_item gspb_grid"+y+" "),m=document.querySelector(`[data-paginationid="${p}"]`);if(m&&(m.setAttribute("data-currentpage",c),m.setAttribute("data-maxpage",u)),"loadmore"===a&&"filter"===t||"numericpagi"===a?i="replace":"loadmore"===a||"infinitescroll"===a?i="append":""===a&&(i="replace"),r){switch(i){case"replace":r.innerHTML="",r.insertAdjacentHTML("beforeend",x);break;case"append":r.innerHTML+=x}"infinitescroll"===a&&"filter"===t&&(r.innerHTML="",r.insertAdjacentHTML("beforeend",d),setTimeout(()=>{gspbFilterInfiniteScrollObserver()},100)),o&&(o.closest(".gs-swiper-init").querySelector(".swiper").swiper.destroy(),GSPB_render_Swiper(o.closest(".gs-swiper-init"))),"pagination"!==t&&null!==n&&(n.innerHTML="",n.insertAdjacentHTML("beforeend",g));let b=r.querySelectorAll(".gspb_grid"+y);b&&b.length>0&&b.forEach(e=>{let t=e.querySelectorAll("[data-gspbactions]");t&&t.length>0&&"function"==typeof GSPB_Trigger_Actions&&GSPB_Trigger_Actions("front",t),"function"==typeof GSPBSlidingPanelInit&&GSPBSlidingPanelInit(e),"function"==typeof gsInitTabs&&gsInitTabs(".gspb-tabs",e),"function"==typeof GSPB_Swiper_Init&&GSPB_Swiper_Init(e),"function"==typeof GS_Videos_Init&&GS_Videos_Init(e),"function"==typeof GSPB_Toggler_Init&&GSPB_Toggler_Init(e),"function"==typeof GSPB_quantityInput&&GSPB_quantityInput(e);let a=new CustomEvent("gsAjaxFilterSuccess",{detail:e});document.dispatchEvent(a)})}let A=decodeURIComponent(e.blockinstance),S=JSON.parse(A),h=document.querySelector(".gs-filters-result-count_"+l);if(!h)return;let I=0;I=S?.attrs?.filter_enable_pagination!=="0"&&S?.attrs?.filter_enable_pagination!==void 0?`${f.startCount}-${f.endCount}`:f.endCount,h&&f&&(h.querySelector(".gs-filters-result-current").textContent=I,h.querySelector(".gs-filters-result-all").textContent=f.totalPosts)}},d.onerror=function(){},d.send("action=filterdata&filterargs="+e.filterargs+"&template="+e.template+"&containerid="+e.containerid+"&filterconnection="+e.filterconnection+"&offset="+e.offset+"&currentpage="+e.currentpage+"&paginationtype="+e.paginationtype+"&innerargs="+e.innerargs+"&blockinstance="+e.blockinstance+"&querycontainer="+e.querycontainer+"&allArgs="+e.allArgs)}async function GSrefreshFilterChips(e,t,a){try{let r=await fetch(RESTVARS.refresh_filterchips,{method:"POST",body:JSON.stringify({filteredIndexData:e,dataConnectionId:a}),headers:{"Content-Type":"application/json"}}),n=await r.json();if(n.success){let{chipsHtml:l}=n.data;l&&(t.innerHTML=l)}}catch(s){console.log(s)}}function GSupdateTaxQuery(e,t,a,r,n){e[t]||(e[t]={taxonomy:t,field:"slug",terms:[],operator:n});let l=e[t];l.terms.includes(a)||l.terms.push(a),e.filteredIndexData,e.filteredIndexData.tax_query,e.filteredIndexData.tax_query[t],e.filteredIndexData.tax_query[t].includes(r)||e.filteredIndexData.tax_query[t].push(r)}function GSremoveTermFromTaxQuery(e,t,a,r){let n=e[t]?.terms||[],l=n.indexOf(a);if(-1!==l){if(n.splice(l,1),e.filteredIndexData&&e.filteredIndexData.tax_query){let s=e.filteredIndexData.tax_query[t]||[],i=s.indexOf(r);-1!==i&&s.splice(i,1),0===s.length&&(e.filteredIndexData.tax_query[t]=[])}0===n.length&&delete e[t]}}function GSupdateTaxArgsObj(e,t,a){return e[t]={taxonomy:t,field:"slug",terms:[],operator:a},e}function GSupdateMetaArgsObj(e,t,a){return e[t]={key:t,value:[],compare:"IN"},"_wc_average_rating"===t&&(e[t].type="NUMERIC"),e}function GSremoveMetaFromMetaQuery(e,t,a,r){let n=e[t]?.value||[],l=n.indexOf(a);if(-1!==l){if(n.splice(l,1),e.filteredIndexData&&e.filteredIndexData.meta_query){let s=e.filteredIndexData.meta_query[t]||[],i=s.indexOf(r);-1!==i&&s.splice(i,1),0===s.length&&(e.filteredIndexData.meta_query[t]=[])}0===n.length&&delete e[t]}}function GSupdateMetaQuery(e,t,a,r){e[t]||(e[t]={key:t,value:[],compare:"IN"});let n=e[t];n.value?.includes(a)||n.value?.push(a),e.filteredIndexData,e.filteredIndexData.meta_query,e.filteredIndexData.meta_query[t],e.filteredIndexData.meta_query[t].includes(r)||e.filteredIndexData.meta_query[t].push(r)}function GSprepareFilterQuery(e,t){let a=e[t];if(!a)return{finalTaxArgs:{},finalMetaArgs:{}};let r={},n=GSexcludeIdsFromBlockInstance(t),l=GSincludeIdsFromBlockInstance(t),s=[];for(let i in Object.keys(n).length>0&&s.push({taxonomy:n.taxonomy,field:n.field||"slug",terms:n.terms,operator:"NOT IN"}),Object.keys(l).length>0&&s.push({taxonomy:l.taxonomy,field:l.field||"slug",terms:l.terms,operator:"IN"}),a)a[i].taxonomy?s.push({taxonomy:a[i].taxonomy,field:a[i].field||"slug",terms:a[i].terms,operator:a[i].operator||"IN"}):a[i].key&&(r[i]=a[i]);let o={};s.length>0&&(o=s.reduce((e,t,a)=>(e[a]=t,e),{relation:"AND"}));let d=Object.keys(r).length>0?{relation:"AND",...r}:{};return{finalTaxArgs:o,finalMetaArgs:d}}function GSupdateMetaRangeObj(e,t){return e[t]={key:t,value:[],compare:"BETWEEN",type:"numeric"},e}document.addEventListener("DOMContentLoaded",()=>{document.addEventListener("change",function(e){"gspbfilter"===e.target.dataset.key&&"radio"!==e.target.type&&GShandleFilterEvent(e.target)}),document.addEventListener("input",function(e){e.target.matches(".gspb-search")&&"gspbfilter"===e.target.dataset.key&&GSdebouncedHandle(e.target)}),document.addEventListener("click",function(e){"gspbfilter"===e.target.dataset.key&&"radio"===e.target.type&&GShandleFilterEvent(e.target)}),onLoadIndexingRestCall(),RESTVARS.preSelect&&Object.keys(RESTVARS.preSelect).length>0&&""!=RESTVARS.preSelect.currentTaxonomoy&&GSActiveCateogry()});const GSonRangeInputHandler=(e,t)=>{let[a,r]=e.querySelectorAll(".gspb-range__slider-input"),n=e.querySelector(".gspb-range__slider-display"),l=Number(a.min),s=Number(a.max),i=Number(a.step||1),o=Number(a.value),d=Number(r.value);d-o<i&&(t.target===a?o=Math.max(l,d-i):d=Math.min(s,o+i));let g=Math.round((o-l)/(s-l)*100),c=Math.round((d-l)/(s-l)*100);e.style.setProperty("--gspb-range-slider-low-val",g),e.style.setProperty("--gspb-range-slider-high-val",c),n.dataset.low=o,n.dataset.high=d,a.value=o,r.value=d,t.target.dataset.min=o,t.target.dataset.max=d};function gspbpaginationHandler(e){if("gspbpagination"!==e.dataset.key)return console.log("This key is not set gspbpagination"),!1;let{page:t,connection:a,type:r}=e.dataset,n=parseInt(t);if(!a||!document.getElementById(a))return console.log("dataconenction id or target element doesn't exists"),!1;let l=document.getElementById(a),s=document.querySelector(`[data-paginationid="currentpage-${a}"]`),i=s?parseInt(s.dataset.maxpage):0,o=document.querySelector(`.next-${a}`),d=document.querySelector(`.prev-${a}`),g=document.querySelector(`#${a} .gspb-filter__ajx-pagination`)?.dataset.type;o.dataset.page=Math.min(n+1,i),d.dataset.page=Math.max(n-1,1),o.style.display=n<i?"block":"none",d.style.display=n>1?"block":"none";if(s.getAttribute("data-currentpage")!=n){let c=GSgenerateFilterData(a,l,g,n);GSfilter_by_rest_func(c,"pagination","numericpagi"),s.setAttribute("data-currentpage",n)}}async function gspbLoadMorepaginationHandler(e,t=""){if("gspbpagination"!==e.dataset.key)return console.log("This key is not set gspbpagination"),!1;let{connection:a,type:r}=e.dataset;if(!a||!document.getElementById(a))return console.log("dataconenction id or targetElement doesn't exists"),!1;let n=document.getElementById(a);0===Object.keys(currentPageObj).length&&(currentPageObj[a]={currentPaged:1,filterPanelEnable:!1}),currentPageObj[a].currentPaged++,currentPageObj[a]={currentPaged:currentPageObj[a].currentPaged,filterPanelEnable:!1};let l=document.querySelector(`#${a} .gspb-filter__ajx-inner`),s=document.querySelector(`[data-paginationid="currentpage-${a}"]`),i=s?parseInt(s.dataset.maxpage):0;l.style.display=currentPageObj[a].currentPaged<i?"block":"none";await GSfilter_by_rest_func(GSgenerateFilterData(a,n,t,currentPageObj[a].currentPaged),"pagination",t),s.setAttribute("data-currentpage",currentPageObj[a].currentPaged),setTimeout(()=>{currentPageObj[a].currentPaged<i&&"infinitescroll"===e.dataset.paginationtype&&GSFilterobserver.observe(e)},1e3)}function gspbFilterInfiniteScrollObserver(){if(!document.querySelectorAll(".gspb_aj_pag_auto_wrap").length)return;let e=document.querySelectorAll(".gspb_aj_pag_auto_wrap .gspb-filter__load_moreajx_btn");e.length>0&&Array.from(e).forEach(function(e){GSFilterobserver.observe(e)})}function GSgetBlockInstance(e){let t=e.replace(/-/g,"_");return JSON.parse(decodeURIComponent(void 0!==window[t]?window[t]:""))}function GSappendCountOfItems(e,t,a){let r=t.tax_query,n=t.meta_query;e.forEach(e=>{let t=e.getAttribute("data-val"),a=e.getAttribute("data-filter"),l=e.getAttribute("data-slug"),s=e.closest(".gspb-item"),i=s.querySelector(".gs-filters-counter"),o=e.tagName.toLowerCase(),d={},g=!1;if("tax_query"===a?d=r[l]||{}:"meta_query"===a&&(d=n[l]||{}),"select"===o){let c=e.options;for(let u=0;u<c.length;u++){let p=c[u].getAttribute("data-val");if(p){let f=c[u].textContent.trim().replace(/\(\d+\)/g,"");if(void 0!==d[p]){let y=d[p];c[u].textContent=`${f} (${y})`}else c[u].textContent=`${f} (0)`}c[u].disabled=!p||void 0===d[p]}}for(let x in d)if(Object.hasOwnProperty.call(d,x)){let m=d[x];if(t===x){i&&(i.textContent=`(${m})`),g=!0;break}}g?(s.style.display="block",s.style.pointerEvents&&(s.style.pointerEvents="auto")):i&&("tax_query"===a?s.style.display="none":(i.textContent="(0)",s.style.opacity="0.5",s.style.pointerEvents="none"))})}async function GSfetchDataAndUpdateElements(e,t,a,r=!1){let n=GSgetBlockInstance(e),l=GSexcludeIdsFromBlockInstance(e),s=GSincludeIdsFromBlockInstance(e);try{let i=await fetch(RESTVARS.indexing_rest_url,{method:"POST",body:JSON.stringify({filterd_data:t,data_limit:n?.attrs?.show,filter_enable_pagination:n?.attrs?.filter_enable_pagination,exclude_taxonomy:l,include_taxonomy:s}),headers:{"Content-Type":"application/json"}}),o=await i.json();if(o&&o.success&&o.indexing){let d=o.indexing,g=a?a.querySelectorAll("[data-slug]"):[];if(GSappendCountOfItems(g,d),r&&a){let c=document.querySelector(".gs-filters-result-count_"+a.dataset.filterid);c&&o.results&&(o.results.queried_count&&(c.querySelector(".gs-filters-result-current").textContent=o.results.queried_count),o.results.total_count&&(c.querySelector(".gs-filters-result-all").textContent=o.results.total_count))}}}catch(u){console.error("Error fetching data:",u)}}async function GSrefreshCountRestCall(e,t,a=!1){if(t){let r=document.querySelectorAll(`.gspb-filterpanel[data-filterid="${t}"]`),n=Array.from(r).map(async r=>{await GSfetchDataAndUpdateElements(t,e,r,a)});await Promise.all(n)}else{let l=document.querySelectorAll(".gspbgrid_list_builder"),s=Array.from(l).map(async a=>{let r=a.getAttribute("id");GSgetBlockInstance(r);let n=`.gspb-filterpanel[data-filterid="${r}"]`;await GSfetchDataAndUpdateElements(t,e,url,n)});await Promise.all(s)}}function onLoadIndexingRestCall(){document.querySelectorAll(".gspbgrid_list_builder").forEach(e=>{let t=GSgetBlockInstance(connectionId=e.getAttribute("id"));taxArgs[connectionId]={filteredIndexData:{post_type:t?.attrs?.post_type?t?.attrs?.post_type:"post",tax_query:{},meta_query:{}}};let a=document.querySelector(`.gspb-filterpanel[data-filterid="${connectionId}"]`);if(a)a.querySelectorAll(".gspb-filterblock").forEach(e=>{let t=e.getAttribute("data-type"),a=e.getAttribute("data-query"),r=e.getAttribute("data-range"),n=e.getAttribute("data-minmax");if("tax_query"===t)taxArgs[connectionId].filteredIndexData.tax_query[a]=[];else if("meta_query"===t){let l="range"===r?`${a}|range`:a,s=[];if("range"===r){s={};let i=n.split("|");s.minmax=n,s.defaultMin=i[0],s.defaultMax=i[1]}taxArgs[connectionId].filteredIndexData.meta_query[l]=s,taxArgs[connectionId].filteredIndexData.search_keyword=""}}),GSrefreshCountRestCall(taxArgs[connectionId].filteredIndexData,connectionId,!0)})}function GSresetFilterData(e,t,a,r,n,l,s,i,o){if(!e)return console.log("dataConnectionId doesn't exist!"),!1;let d=t.dataset,g=e.replace(/-/g,"_"),c=void 0!==window[g]?window[g]:"",u=GSgetBlockInstance(e),p=u?.attrs?.post_type,f=u?.attrs?.show;taxArgs[e]||(taxArgs[e]={}),taxArgs[e].post_type=p||"post",taxArgs[e].posts_per_page=f||12,taxArgs[e].filteredIndexData.post_type=p||"post";let y=d?.filterargs?JSON.parse(d?.filterargs):{},x=document.querySelector(`#${e} .wp-block-post-template`),m=document.querySelector(`#${e} .gspb-filter__ajx-pagination`),b=GSgenerateLoader(x,e),A=taxArgs[e];if("all"===a){for(let S in A.filteredIndexData.tax_query)Object.prototype.hasOwnProperty.call(A.filteredIndexData.tax_query,S)&&(A.filteredIndexData.tax_query[S]=[],delete A[S]);for(let h in A.filteredIndexData.meta_query)if(Object.prototype.hasOwnProperty.call(A.filteredIndexData.meta_query,h)){if(h.includes("|range")){let I=A.filteredIndexData.meta_query[h];A.filteredIndexData.meta_query[h].minmax=`${I.defaultMin}|${I.defaultMax}`}else A.filteredIndexData.meta_query[h]=[],taxArgs[e][h]=[]}for(let q in taxArgs[e])"post_type"!==q&&"posts_per_page"!==q&&"filteredIndexData"!==q&&"search"!==q&&(taxArgs[e][q]=[]);A.filteredIndexData.search_keyword="",taxArgs[e].search=""}else if("single"===a){if("gspb-search"!==i){if("range__input"!==o.type){if(A.filteredIndexData[l][s]){let k=A.filteredIndexData[l][s];if(k.includes(i)){let v=k.filter(e=>e!==i);A.filteredIndexData[l][s]=v}}}else if(A.filteredIndexData[l][`${s}|range`]){let D=`${o.min}|${o.max}`;A.filteredIndexData[l][`${s}|range`].minmax=D}if(taxArgs[e][s]){let G=taxArgs[e][s].terms,$=taxArgs[e][s].value,w;if((G?.includes(n)||$?.includes(n))&&(G&&(w=G.filter(e=>e!==n),taxArgs[e][s].terms=w),"range__input"!==o.type&&$&&(w=$.filter(e=>e!==n),taxArgs[e][s].value=w),0===w.length&&delete taxArgs[e][s]),"range__input"===o.type){$[0]=o.min,$[1]=o.max;let C=o.minmax.split("|");C[0]===o.min&&C[1]===o.max&&delete taxArgs[e][s]}}}else A.filteredIndexData.search_keyword="",delete taxArgs[e].search}let{finalTaxArgs:E,finalMetaArgs:_}=GSprepareFilterQuery(taxArgs,e);return Object.assign(y,{tax_query:E,meta_query:_,post_type:taxArgs[e].post_type,posts_per_page:taxArgs[e].posts_per_page,s:taxArgs[e].search}),{filterargs:JSON.stringify(y),template:d.template,containerid:e,filterconnection:e,offset:void 0,currentpage:1,paginationtype:r,innerargs:d.innerargs,blockinstance:c,querycontainer:x,paginationcontainer:m,loaderContainer:b,allArgs:JSON.stringify(A)}}function GSgenerateLoader(e,t){let a=document.querySelector(`#${t} .gspb-filter-post-loader-container`);if(!a){(a=document.createElement("div")).classList.add("gspb-filter-post-loader-container");let r=document.createElement("span");r.classList.add("gspb-filter-loader"),a.appendChild(r),e.parentNode.insertBefore(a,e)}return a}function GSActiveCateogry(){let e=document.querySelectorAll("input[data-slug]");e.forEach(e=>{let t=e.value;RESTVARS.preSelect.currentTaxonomoy===t&&e.click()})}function GSexcludeIdsFromBlockInstance(e){let t=GSgetBlockInstance(e),a=t?.attrs?.tax_slug_exclude,r=t?.attrs?.tax_name,n=[];return a&&0!==a.length?n={taxonomy:r,field:"slug",terms:excludedCategories=a.map(e=>e.id).filter(Boolean),operator:"NOT IN"}:[]}function GSincludeIdsFromBlockInstance(e){let t=GSgetBlockInstance(e),a=t?.attrs?.tax_slug,r=t?.attrs?.tax_name,n=[];return a&&0!==a.length?n={taxonomy:r,field:"slug",terms:includedCategories=a.map(e=>e.id).filter(Boolean),operator:"IN"}:[]}document.addEventListener("DOMContentLoaded",e=>{let t=document.querySelectorAll(".gspb-range__slider");t.forEach(e=>{let t=e.querySelectorAll(".gspb-range__slider-input");t.forEach(t=>{t.addEventListener("input",t=>{"gspbfilter"===t.target.dataset.key&&GSonRangeInputHandler(e,t)})})})}),document.addEventListener("DOMContentLoaded",function(){document.addEventListener("click",function(e){if("numericpagi"===e.target.dataset.paginationtype&&"gspbpagination"===e.target.dataset.key){let t=document.querySelectorAll(`[data-paginationtype="${e.target.dataset.paginationtype}"]`);t.forEach(e=>e.classList.remove("gspb-pg-active")),e.target.classList.add("gspb-pg-active"),gspbpaginationHandler(e.target)}"loadmore"===e.target.dataset.paginationtype&&gspbLoadMorepaginationHandler(e.target,"loadmore")})}),gspbFilterInfiniteScrollObserver();